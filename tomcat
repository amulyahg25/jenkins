#install open jdk
sudo apt install openjdk-8-jdk
#verify version
java -version
sudo groupadd tomcat
sudo useradd -s /bin/false -g tomcat -d /opt/tomcat tomcat
wget -O tomcat.tar.gz https://archive.apache.org/dist/tomcat/tomcat-9/v9.0.91/bin/apache-tomcat-9.0.91.tar.gz
sudo mkdir /opt/tomcat
sudo tar -xvzf tomcat.tar.gz -C /opt/tomcat --strip-components=1
sudo chown -R tomcat:tomcat /opt/tomcat
sudo chmod -R g+r /opt/tomcat/conf
sudo chmod g+x /opt/tomcat/conf

#add these lines above </tomcat-users>
sudo nano /opt/tomcat/conf/tomcat-users.xml
    <role rolename="manager-gui" /> 
    <role rolename="manager-script" />
    <role rolename="admin-gui" />
    <user username="msis" password="msis@123" roles="manager-gui,manager-script,adm>

#Disbale this below line
sudo nano /opt/tomcat/webapps/manager/META-INF/context.xml
   <!--  <Valve className="org.apache.catalina.valves.RemoteAddrValve"
         allow="127\.\d+\.\d+\.\d+|::1|0:0:0:0:0:0:0:1" /> -->

#Disbale this below line
sudo nano /opt/tomcat/webapps/host-manager/META-INF/context.xml
   <!--  <Valve className="org.apache.catalina.valves.RemoteAddrValve"
         allow="127\.\d+\.\d+\.\d+|::1|0:0:0:0:0:0:0:1" /> -->
sudo update-java-alternatives -l

sudo nano /etc/systemd/system/tomcat.service
  [Unit]
  Description=Tomcat
  After=network.target

  [Service]
  Type=forking

  User=tomcat
  Group=tomcat

  Environment="JAVA_HOME=/usr/lib/jvm/java-8-openjdk-amd64"
  Environment="JAVA_OPTS=-Djava.security.egd=file:///dev/urandom"
  Environment="CATALINA_BASE=/opt/tomcat"
  Environment="CATALINA_HOME=/opt/tomcat"
  Environment="CATALINA_PID=/opt/tomcat/temp/tomcat.pid"
  Environment="CATALINA_OPTS=-Xms512M -Xmx1024M -server -XX:+UseParallelGC"

  ExecStart=/opt/tomcat/bin/startup.sh
  ExecStop=/opt/tomcat/bin/shutdown.sh
sudo systemctl daemon-reload
sudo systemctl enable tomcat
sudo systemctl start tomcat
sudo systemctl status tomcat








